/*
tyto - http://jh3y.github.io/tyto
Licensed under the MIT license

jh3y (c) 2017

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
!function(){!function t(e,o,i){function n(l,a){if(!o[l]){if(!e[l]){var r="function"==typeof require&&require;if(!a&&r)return r(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[l]={exports:{}};e[l][0].call(u.exports,function(t){var o=e[l][1][t];return n(o?o:t)},u,u.exports,t,e,o,i)}return o[l].exports}for(var s="function"==typeof require&&require,l=0;l<i.length;l++)n(i[l]);return n}({1:[function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var n=t("./config/tyto"),s=i(n),l=t("./templates/templates"),a=i(l),r=t("./controllers/tyto"),d=i(r),u=t("./views/tyto"),c=i(u),m=t("./models/tyto"),_=i(m),p=t("./utils/utils"),y=i(p),b=t("./utils/suggestions"),f=i(b),T=new s["default"];window.Tyto=T,T.TemplateStore=a["default"],T.module("Models",_["default"]),T.module("Ctrl",d["default"]),T.module("Views",c["default"]),T.module("Utils",y["default"]),T.module("Suggestions",f["default"]),T.Boards=new T.Models.BoardCollection,T.Columns=new T.Models.ColumnCollection,T.Tasks=new T.Models.TaskCollection,T.ActiveBoard=new T.Models.Board,T.ActiveCols=new T.Models.ColumnCollection,T.ActiveTasks=new T.Models.TaskCollection,T.on("before:start",function(){return T.setRootLayout()}),T.on("start",function(){return T.__renderer=new marked.Renderer,T.__renderer.link=function(t,e,o){var i,n,s;if(this.options.sanitize){try{s=decodeURIComponent(unescape(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(l){return i=l,""}if(0===s.indexOf("javascript:")||0===s.indexOf("vbscript:"))return""}return n='<a target="_blank" href="'+t+'"',e&&(n+=' title="'+e+'"'),n+=">"+o+"</a>"},marked.setOptions({renderer:T.__renderer}),T.Controller=new T.Ctrl.Controller,T.Controller.Router=new T.Ctrl.Router({controller:T.Controller}),T.Controller.start(),Backbone.history.start()}),T.Utils.load(window.localStorage),T.start()},{"./config/tyto":2,"./controllers/tyto":3,"./models/tyto":4,"./templates/templates":5,"./utils/suggestions":6,"./utils/utils":7,"./views/tyto":17}],2:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Marionette.Application.extend({navigate:function(t,e){Backbone.history.navigate(t,e)},setRootLayout:function(){Tyto.RootView=new Tyto.Views.Root},NAVIGATION_DURATION:500,TASK_COLORS:["yellow","red","blue","indigo","green","purple","orange","pink"],DEFAULT_TASK_COLOR:"yellow",ANIMATION_EVENT:"animationend webkitAnimationEnd oAnimationEnd",INTRO_JSON_SRC:"js/intro.json",LOADING_CLASS:"is--loading",SELECTED_CLASS:"is--selected",CONFIRM_MESSAGE:"[tyto] are you sure you wish to delete this item?"});o["default"]=i},{}],3:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(t,e,o,i){t.Router=i.AppRouter.extend({appRoutes:{"board/:board":"showBoardView","board/:board/task/:task":"showEditView","board/:board/task/:task?:params":"showEditView","*path":"showSelectView"}}),t.Controller=i.Controller.extend({start:function(){this.showMenu(),window.localStorage&&!window.localStorage.tyto&&this.showCookieBanner()},showSelectView:function(){Tyto.SelectView=new e.Views.Select({collection:Tyto.Boards}),Tyto.RootView.showChildView("Content",Tyto.SelectView)},showMenu:function(){Tyto.MenuView=new e.Views.Menu,Tyto.RootView.showChildView("Menu",Tyto.MenuView)},showCookieBanner:function(){Tyto.RootView.$el.prepend($('<div id="cookie-banner"></div>')),Tyto.RootView.addRegion("Cookie","#cookie-banner"),Tyto.CookieBannerView=new e.Views.CookieBanner,Tyto.RootView.showChildView("Cookie",Tyto.CookieBannerView)},showBoardView:function(t){var o=void 0,i=void 0,n=void 0;Tyto.ActiveBoard=i=Tyto.Boards.get(t),i?(o=Tyto.Columns.where({boardId:i.id}),n=Tyto.Tasks.where({boardId:i.id}),Tyto.ActiveTasks.reset(n),Tyto.ActiveCols.reset(o),Tyto.BoardView=new e.Views.Board({model:i,collection:Tyto.ActiveCols,options:{tasks:Tyto.ActiveTasks}}),e.RootView.showChildView("Content",Tyto.BoardView)):e.navigate("/",!0)},showEditView:function(t,o,i){var n=void 0,s=Tyto.Boards.get(t),l=Tyto.Columns.where({boardId:t}),a=!1;if(i){var r=Tyto.Utils.processQueryString(i);"true"===r.isFresh&&(a=!0,n=Tyto.TempTask=new Tyto.Models.Task({boardId:t,id:o}))}else n=Tyto.Tasks.get(o);n&&s?(Tyto.EditView=new e.Views.Edit({model:n,board:s,columns:l,isNew:a}),e.RootView.showChildView("Content",Tyto.EditView)):s?Tyto.navigate("/board/"+s.id,!0):Tyto.navigate("/",!0)}})};o["default"]=i},{}],4:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(t,e,o){t.Board=o.Model.extend({defaults:{title:"New Board"}}),t.BoardCollection=o.Collection.extend({localStorage:new o.LocalStorage("tyto--board"),model:t.Board}),t.Column=o.Model.extend({defaults:{title:"New Column",ordinal:1},localStorage:new o.LocalStorage("tyto--column")}),t.ColumnCollection=o.Collection.extend({model:t.Column,localStorage:new o.LocalStorage("tyto--column")}),t.Task=o.Model.extend({defaults:{title:"New Todo",description:"Making this work!",color:"yellow",timeSpent:{hours:0,minutes:0,seconds:0}},localStorage:new o.LocalStorage("tyto--task")}),t.TaskCollection=o.Collection.extend({localStorage:new o.LocalStorage("tyto--task"),model:t.Task})};o["default"]=i},{}],5:[function(t,e,o){"use strict";e.exports={board:function(t){var e,o="";Array.prototype.join;return o+='<div class="tyto-board__options"><button class="mdl-button mdl-js-button mdl-button--icon tyto-board__menu-btn " id="tyto-board__menu" title="Board options"><i class="material-icons">more_vert</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-board__menu mdl-menu--bottom-right" for="tyto-board__menu"><li class="tyto-board__wipe-board mdl-menu__item">Wipe board</li><li class="tyto-board__delete-board mdl-menu__item">Delete board</li><li class="tyto-board__email-board mdl-menu__item">Email board</li><a class="tyto-board__emailer" style="display: none;"></a></ul></div><div class="tyto-board__details"><h1 class="tyto-board__title bg--white" contenteditable="true">'+(null==(e=t.title)?"":e)+"</h1>",t.boards.length>1&&(o+='<button class="mdl-button mdl-js-button mdl-button--icon tyto-board__selector__menu-btn " id="tyto-board__selector" title="Select a board"><i class="material-icons">expand_more</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-board__selector__menu mdl-menu--bottom-right" for="tyto-board__selector">',_.each(t.boards.models,function(i){o+="\n",i.attributes.id!=t.id&&(o+='<li class="mdl-menu__item tyto-board__selector-option" title="View board"><a href="#board/'+(null==(e=i.attributes.id)?"":e)+'">'+(null==(e=i.attributes.title)?"":e)+"</a></li>"),o+="\n"}),o+="</ul>"),o+='</div><div class="tyto-board__columns"></div><div class="tyto-board__actions mdl-button--fab_flinger-container"><button class="tyto-board__add-entity mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored"><i class="material-icons">add</i></button><div class="mdl-button--fab_flinger-options"><button class="tyto-board__super-add mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" title="Add task"><i class="material-icons">description</i><i class="material-icons sub">add</i></button><button class="tyto-board__add-column mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" title="Add column"><i class="material-icons">view_column</i><i class="material-icons sub">add</i></button></div></div><div class="tyto-board__bloomer"></div>'},column:function(t){var e,o="";return o+='<div class="tyto-column__content"><div class="tyto-column__actions"><i class="tyto-column__mover material-icons does--fade" title="Move column">open_with</i><h6 class="tyto-column__title input--fade bg--white" contenteditable="true" title="Column title">'+(null==(e=t.title)?"":e)+'</h6><button class="mdl-button mdl-js-button mdl-button--icon tyto-column__menu-btn does--fade" id="'+(null==(e=t.id)?"":e)+'--menu" title="Column options"><i class="material-icons">more_vert</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-column__menu mdl-menu--bottom-right" for="'+(null==(e=t.id)?"":e)+'--menu"><li class="tyto-column__delete-column mdl-menu__item" title="Delete column">Delete</li><li class="tyto-column__add-task mdl-menu__item" title="Add task">Add task</li></ul></div><div class="tyto-column__tasks"></div><div class="tyto-column__action"><i class="material-icons tyto-column__add-task does--fade" title="Add task">add</i></div></div>'},cookieBanner:function(t){var e="";return e+='<div class="tyto-cookies bg--blue"><img src="img/tyto.png"/><p>tyto uses cookies that enable it to provide functionality and a better user experience. By using tyto and closing this message you agree to the use of cookies. <a href="cookies.html" target="_blank">Read more...</a></p><button class="tyto-cookies__accept mdl-button mdl-js-button mdl-button--raised mdl-button--accent mdl-js-ripple-effect">Close</button></div>'},edit:function(t){var e,o="";Array.prototype.join;return o+='<div class="tyto-edit__nav">',o+=t.isNew?'<button class="tyto-edit__save mdl-button mdl-js-button mdl-js-ripple-effect">Done</button><a class="tyto-edit__cancel mdl-button mdl-js-button mdl-js-ripple-effect" href="#board/'+(null==(e=t.board.id)?"":e)+'">Cancel</a>':'<a class="tyto-edit__back mdl-button mdl-js-button mdl-js-ripple-effect" href="#board/'+(null==(e=t.board.id)?"":e)+'">Return to board</a>',o+='</div><div class="tyto-edit__content"><div class="tyto-edit__details has--bottom-margin"><h1 class="tyto-edit__task-title" contenteditable="true" data-model-prop="title" title="Task title">'+(null==(e=t.title)?"":e)+'</h1><div class="tyto-edit__task-description" title="Task description">'+(null==(e=t.description)?"":e)+'</div><div class="tyto-task__edit-wrapper"><textarea class="tyto-edit__edit-description is--hidden" data-model-prop="description"></textarea><div class="tyto-task__suggestions tyto-suggestions__container mdl-shadow--2dp is--hidden"></div></div></div><div class="tyto-edit__details-footer tx--right has--bottom-margin"><div class="tyto-time tyto-edit__task-time" title="Time spent"><i class="tyto-time__icon material-icons">schedule</i><span class="tyto-edit__task-time__hours tyto-time__hours">'+(null==(e=t.timeSpent.hours)?"":e)+'h</span><span class="tyto-edit__task-time__minutes tyto-time__minutes">'+(null==(e=t.timeSpent.minutes)?"":e)+'m</span></div><div class="tyto-edit__task-column">',t.selectedColumn&&(o+="\n"+(null==(e=t.selectedColumn.attributes.title)?"":e)+"\n"),o+='</div></div><div class="tyto-edit__actions">',t.columns.length>0&&(o+='<button class="mdl-button mdl-js-button mdl-button--icon tyto-edit__column-select__menu-btn " id="column-select" title="Select column"><i class="material-icons">view_column</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-edit__column-select__menu mdl-menu--bottom-right" for="column-select">',_.forEach(t.columns,function(i){if(o+="\n",!t.isNew)var n=i.attributes.id===t.columnId?"is--selected":"";o+='<li class="mdl-menu__item tyto-edit__column-select__menu-option '+(null==(e=n)?"":e)+'" data-column-id="'+(null==(e=i.id)?"":e)+'">'+(null==(e=i.attributes.title)?"":e)+"</li>"}),o+="</ul>"),o+='<button class="mdl-button mdl-js-button mdl-button--icon tyto-edit__color-select__menu-btn " id="color-select" title="Change color"><i class="material-icons">color_lens</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-edit__color-select__menu mdl-menu--bottom-right" for="color-select">',_.forEach(t.colors,function(i){o+="\n";i===t.color?"is--selected":"";o+='<li class="mdl-menu__item tyto-edit__color-select__menu-option bg--'+(null==(e=i)?"":e)+" hv--"+(null==(e=i)?"":e)+" "+(null==(e=t.activeColor)?"":e)+'" data-color="'+(null==(e=i)?"":e)+'" title="'+(null==(e=i)?"":e)+'"></li>'}),o+='</ul><button class="tyto-edit__track mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect" title="Start tracking"><i class="material-icons">schedule</i></button></div></div>'},filterList:function(t){var e,o="";Array.prototype.join;return o+='<ul class="tyto-suggestions__list">',t.models.length>0?(o+="\n",_.each(t.models,function(t){o+="\n",o+=t.attributes.boardId?'<li class="tyto-suggestions__item" data-type="Tasks" data-model-id="'+(null==(e=t.attributes.id)?"":e)+'">'+(null==(e=t.attributes.title)?"":e)+"</li>":'<li class="tyto-suggestions__item" data-type="Boards" data-model-id="'+(null==(e=t.attributes.id)?"":e)+'">'+(null==(e=t.attributes.title)?"":e)+"</li>",o+="\n"}),o+="\n"):o+='<li class="tyto-suggestions__item">No suggestions available...</li>',o+="</ul>"},menu:function(t){var e="";return e+='<div class="mdl-layout-title"><div class="tyto-menu__title"><h1>tyto</h1></div></div><ul class="tyto-menu__actions"><li><button class="tyto-menu__add-board mdl-button mdl-js-button mdl-js-ripple-effect">Add new board</button></li><li><button class="tyto-menu__import mdl-button mdl-js-button mdl-js-ripple-effect" id="import-data">Import data</button></li><li><button class="tyto-menu__load mdl-button mdl-js-button mdl-js-ripple-effect" id="load-data">Load data</button></li><li><button class="tyto-menu__export mdl-button mdl-js-button mdl-js-ripple-effect">Export data</button></li><li><button class="tyto-menu__delete-save mdl-button mdl-js-button mdl-js-ripple-effect">Delete data</button></li><a class="tyto-menu__exporter"></a><input class="tyto-menu__importer" type="file"/><li><div class="github-stats"><div class="github-stats__stars"><iframe src="http://ghbtns.com/github-btn.html?user=jh3y&amp;repo=tyto&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="90px" height="20"></iframe></div><div class="github-stats__forks"><iframe src="http://ghbtns.com/github-btn.html?user=jh3y&amp;repo=tyto&amp;type=fork&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="90px" height="20"></iframe></div><div class="github-stats__user"><iframe src="http://ghbtns.com/github-btn.html?user=jh3y&amp;repo=tyto&amp;type=follow&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="120px" height="20"></iframe></div></div></li></ul>'},select:function(t){var e,o="";Array.prototype.join;return t.items&&0!=t.items.length?(o+='<p><span>To start, select one of your boards.</span><div class="selector"><select class="tyto-select__board-selector"><option>--select a board--</option>',_.each(t.items,function(t){o+='<option value="'+(null==(e=t.id)?"":e)+'">'+(null==(e=t.title)?"":e)+"</option>"}),o+='</select></div></p><p><span>Alternatively,</span><button class="tyto-select__add-board mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Add a board</button></p>'):o+='<p><span>To start,</span><button class="tyto-select__add-board mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Add a board</button></p><p><span>or</span><button class="tyto-select__load-intro-board mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Load the intro board</button></p>',o},task:function(t){var e,o="";Array.prototype.join;o+='<div class="tyto-task__content"><div class="tyto-task__header tx--center"><i class="material-icons tyto-task__mover does--fade" title="Move task">open_with</i><h2 class="tyto-task__title" contenteditable="true" title="Task title">'+(null==(e=t.title)?"":e)+'</h2><button class="mdl-button mdl-js-button mdl-button--icon tyto-task__menu-btn does--fade" id="'+(null==(e=t.id)?"":e)+'--menu" title="Task options"><i class="material-icons">more_vert</i></button><ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect tyto-task__menu mdl-menu--bottom-right" for="'+(null==(e=t.id)?"":e)+'--menu"><li class="mdl-menu__item tyto-task__delete-task" title="Delete task">Delete</li><li class="mdl-menu__item tyto-task__edit-task" title="Edit task">Edit</li><li class="mdl-menu__item tyto-task__track-task" title="Track task time">Track</li></ul></div><div class="mdl-card__supporting-text tyto-task__description" title="Task description">'+(null==(e=t.description)?"":e)+'</div><div class="tyto-task__edit-wrapper"><textarea class="tyto-task__description-edit is--hidden"></textarea><div class="tyto-task__suggestions tyto-suggestions__container mdl-shadow--2dp is--hidden"></div></div>';t.timeSpent.hours>0||t.timeSpent.minutes>0?"":"is--hidden";return o+='<div class="tyto-time tyto-task__time" title="Time spent"><i class="tyto-time__icon material-icons">schedule</i><span class="tyto-task__time__hours tyto-time__hours">'+(null==(e=t.timeSpent.hours)?"":e)+'h</span><span class="tyto-task__time__minutes tyto-time__minutes">'+(null==(e=t.timeSpent.minutes)?"":e)+"m</span></div></div>"},timeModal:function(t){var e,o="";return o+='<div class="tyto-time-modal__content mdl-card mdl-shadow--4dp"><div class="tyto-time-modal__content-title mdl-card__title"><h2 class="mdl-card__title-text">'+(null==(e=t.title)?"":e)+'</h2></div><div class="tyto-time-modal__content-text tx--center mdl-card__supporting-text"><p class="tyto-time-modal__content-description"></p><h1 class="tyto-time-modal__timer-lbl"><span class="tyto-time-modal__timer-lbl-hours"></span><span>:</span><span class="tyto-time-modal__timer-lbl-minutes"></span><span>:</span><span class="tyto-time-modal__timer-lbl-seconds"></span></h1></div><div class="tyto-time-modal__actions mdl-card__actions mdl-card--border tx--center"><button class="tyto-time-modal__timer-reset mdl-button mdl-js-button mdl-button--icon mdl-button--accent mdl-js-ripple-effect" title="Reset time"><i class="material-icons">restore</i></button><button class="tyto-time-modal__timer mdl-button mdl-js-button mdl-button--icon mdl-button--accent mdl-js-ripple-effect" title="Stop/Start tracking"><i class="tyto-time-modal__timer-icon material-icons">play_arrow</i></button><button class="tyto-time-modal__close mdl-button mdl-js-button mdl-button--icon mdl-button--accent mdl-js-ripple-effect" title="Exit tracking"><i class="material-icons">clear</i></button></div></div>'}}},{}],6:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(t,e,o,i){t.proto=["filterItems","selectSuggestion","renderSuggestions","hideSuggestions"],t.props={ACTIVE_CLASS:"is--active",SUGGESTIONS_ITEM:".tyto-suggestions__item"},t.bootstrapView=function(e){t.proto.forEach(function(o){e[o]=t[o]})},t.renderSuggestions=function(t){var e=function(e){return e.attributes.title.toLowerCase().indexOf(t.toLowerCase())!==-1},o=this,i=o.ui.editDescription,n=o.domAttributes,s=o.ui.suggestions,l=Tyto.Boards.models.concat(Tyto.Tasks.models);l=t?l.filter(e):l;var a=Tyto.TemplateStore.filterList({models:l.slice(0,4)}),r=$("body"),d=$(".tyto-column__tasks"),u=i[0].selectionEnd,c=o.__EDIT_START+1,m=i[0].value,_=function b(t){var e=t.target;"LI"!==e.nodeName&&"TEXTAREA"!==e.nodeName?(o.hideSuggestions(),o.delegateEvents(),i.blur(),r.off("click",b)):"TEXTAREA"===e.nodeName&&(u<c||m.substring(c,u).indexOf(" ")!==-1)&&o.hideSuggestions()},p=function f(t){o.delegateEvents(),i.focus(),r.off("click",_),d.off("scroll",f),i.off("scroll",f),o.hideSuggestions()};if(o.$el.off("blur","."+i[0].className),r.on("click",_),d.on("scroll",p),i.on("scroll",p),o.__EDIT_MODE)s.html(a);else{o.__EDIT_MODE=!0,o.__EDIT_START=i[0].selectionStart;var y=Tyto.Utils.getCaretPosition(i[0]);s.html(a).css({left:y.LEFT,top:y.TOP}).removeClass(n.HIDDEN_UTIL_CLASS)}},t.hideSuggestions=function(){var t=this,e=t.domAttributes;t.__EDIT_MODE=!1,t.__ACTIVE_SUGGESTION=null,t.__EDIT_MODE_IN_SELECTION=!1;var o=t.ui.suggestions;o.addClass(e.HIDDEN_UTIL_CLASS)},t.filterItems=function(e){var o=this,i=o.ui.suggestions,n=(o.domAttributes,o.ui.editDescription),s=e.which,l=n[0].selectionStart,a=n[0].selectionEnd,r=n[0].value;if(35!==s||o.__EDIT_MODE){if(o.__EDIT_MODE)switch(s){case 35:case 32:o.hideSuggestions();case 13:o.__EDIT_MODE_IN_SELECTION&&null!==o.__ACTIVE_SUGGESTION?(e.preventDefault(),o.__ACTIVE_SUGGESTION.click()):o.hideSuggestions();break;case 8:a===o.__EDIT_START?o.hideSuggestions():o.renderSuggestions(r.substring(o.__EDIT_START+1,a));break;case 38:case 40:if("keydown"===e.type){e.preventDefault();var d=38===s?"prev":"next",u=38===s?"last":"first";o.__EDIT_MODE_IN_SELECTION?0===o.__ACTIVE_SUGGESTION[d]().length?(o.__ACTIVE_SUGGESTION.removeClass(t.props.ACTIVE_CLASS),o.__ACTIVE_SUGGESTION=i.find(t.props.SUGGESTIONS_ITEM)[u]().addClass(t.props.ACTIVE_CLASS)):o.__ACTIVE_SUGGESTION=o.__ACTIVE_SUGGESTION.removeClass(t.props.ACTIVE_CLASS)[d]().addClass(t.props.ACTIVE_CLASS):(o.__EDIT_MODE_IN_SELECTION=!0,o.__ACTIVE_SUGGESTION=i.find(t.props.SUGGESTIONS_ITEM)[u]().addClass(t.props.ACTIVE_CLASS))}break;case 37:case 39:"keyup"===e.type&&(a<o.__EDIT_START+1||r.substring(o.__EDIT_START,a).length!==r.substring(o.__EDIT_START,a).trim().length)&&o.hideSuggestions();break;default:"keyup"===e.type&&o.renderSuggestions(r.substring(o.__EDIT_START+1,a))}}else{var c=r.charAt(l-1).trim(),m=r.charAt(l).trim();""===c&&""===m&&o.renderSuggestions()}},t.selectSuggestion=function(t){var e=this,o=e.ui.editDescription,i=t.target.getAttribute("data-type"),n=t.target.getAttribute("data-model-id");if(i){var s=Tyto[i].get(n),l=void 0;if(s.attributes.boardId){var a=Tyto.Tasks.get(n).attributes.boardId;l="#board/"+a+"/task/"+n}else l="#board/"+n;l="["+s.attributes.title+"]("+l+")";var r=o[0].value.slice(0,e.__EDIT_START),d=o[0].value.slice(o[0].selectionEnd,o[0].value.length);o[0].value=r+" "+l+" "+d}$("body").off("click"),e.ui.editDescription.focus(),e.hideSuggestions(),e.delegateEvents()}};o["default"]=i},{}],7:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(t,e,o,i){return t.upgradeMDL=function(t){_.forEach(t,function(t,e){t.el&&componentHandler.upgradeElement(t.el,t.component)})},t.reorder=function(t,e,o){var i=t.collection;_.forEach(e,function(t,e){var n=t.getAttribute(o),s=i.get(n);s&&s.save({ordinal:e+1})})},t.autoSize=function(t){var e=function(){t.style.height="auto",t.style.height=t.scrollHeight+"px"};t.addEventListener("keydown",e),t.addEventListener("input",e),t.addEventListener("focus",e),e()},t.getCaretPosition=function(t){var e=t.selectionEnd,o=document.createElement("div"),i=document.createElement("span"),n=getComputedStyle(t),s=t.getBoundingClientRect();[].forEach.call(n,function(t){return o.style[t]=n[t]}),o.style.position="absolute",o.textContent=t.value.substr(0,e),i.textContent=t.value.substr(e)||".",o.appendChild(i),document.body.appendChild(o);var l=parseFloat(n.fontSize.replace("px",""),10),a=t.offsetTop-t.scrollTop+i.offsetTop+l;a=a>t.offsetHeight?t.offsetHeight:a;var r=t.offsetLeft-t.scrollLeft+i.offsetLeft,d={TOP:a+s.top+"px",LEFT:r+s.left+"px"};return document.body.removeChild(o),d},t.processQueryString=function(t){var e={},o=function(t){t=t.split("="),e[t[0]]=t[1]};return t.split("&").map(o),e},t.bloom=function(t,e,o){var i=Tyto.BoardView.ui.bloomer,n=i[0],s=t.getBoundingClientRect();n.style.left=s.left+s.width/2+"px",n.style.top=s.top+s.height/2+"px",n.className="tyto-board__bloomer bg--"+e,n.classList.add("is--blooming"),Tyto.RootView.el.classList.add("is--showing-bloom");var l=function a(){i.off(Tyto.ANIMATION_EVENT,a),Tyto.navigate(o,!0)};i.on(Tyto.ANIMATION_EVENT,l)},t.load=function(t,e,o){var i=[],n=[],s=[],l={};e&&(delete t.tyto,delete t["tyto--board"],delete t["tyto--column"],delete t["tyto--task"]),o&&_.forOwn(window.localStorage,function(t,e){e.indexOf("tyto")!==-1&&window.localStorage.removeItem(e)}),_.forOwn(t,function(t,a){var r=void 0,d=void 0;o&&window.localStorage.setItem(a,t),a.indexOf("tyto--board-")!==-1&&(e?(r=JSON.parse(t),void 0!==Tyto.Boards.get(r.id)&&(d=r.id,delete r.id),l[d]=Tyto.Boards.create(r).id):i.push(JSON.parse(t))),a.indexOf("tyto--column-")!==-1&&(e?(r=JSON.parse(t),l[r.boardId]&&(r.boardId=l[r.boardId]),void 0!==Tyto.Columns.get(r.id)&&(d=r.id,delete r.id),l[d]=Tyto.Columns.create(r).id):n.push(JSON.parse(t))),a.indexOf("tyto--task-")!==-1&&(e?(r=JSON.parse(t),l[r.boardId]&&(r.boardId=l[r.boardId]),l[r.columnId]&&(r.columnId=l[r.columnId]),void 0!==Tyto.Tasks.get(r.id)&&(d=r.id,delete r.id),l[d]=Tyto.Tasks.create(r).id):s.push(JSON.parse(t)))}),e||(Tyto.Boards.reset(i),Tyto.Columns.reset(n),Tyto.Tasks.reset(s))},t.EMAIL_TEMPLATE="\n    <div>\n      Status for: <%= board.title %>\n      <% if (columns.length > 0 && tasks.length > 0) { %>\n        <% _.forEach(columns, function(column) { %>\n          <%= column.attributes.title %>\n          &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;\n          <% _.forEach(tasks, function(task) { %>\n            <% if (task.attributes.columnId === column.attributes.id) { %>\n              &#8226; <%= task.attributes.title %>\n              \n\n              <%= task.attributes.description %>\n              <% if (task.attributes.timeSpent.hours > 0 || task.attributes.timeSpent.minutes > 0) { %>\n                \n\n                -- <%=task.attributes.timeSpent.hours %> hours, <%= task.attributes.timeSpent.minutes %> minutes.\n              <% } %>\n            <% } %>\n          <% });%>\n        <% }); %>\n      <% } else { %>\n        Seems we are way ahead, so treat yourself and go grab a coffee! :)\n      <% } %>\n    </div>",t.getEmailContent=function(t){var e="Status for "+Tyto.ActiveBoard.get("title")+" as of "+(new Date).toString(),o=_.template(Tyto.Utils.EMAIL_TEMPLATE),i=o({board:t.attributes,columns:Tyto.Columns.where({boardId:t.id}),tasks:Tyto.Tasks.where({boardId:t.id})});return i=encodeURIComponent($(i).text()),"mailto:someone@somewhere.com?subject="+encodeURIComponent(e.trim())+"&body="+i},t.showTimeModal=function(t,o){Tyto.RootView.$el.prepend($('<div class="tyto-time-modal__wrapper"></div>')),Tyto.RootView.addRegion("TimeModal",".tyto-time-modal__wrapper"),Tyto.TimeModalView=new e.Views.TimeModal({model:t,modelView:o}),Tyto.RootView.showChildView("TimeModal",Tyto.TimeModalView)},t.getRenderFriendlyTime=function(t){for(var e={},o=["hours","minutes","seconds"],i=0;i<o.length;i++){var n=o[i];e[n]=t[n]<10?"0"+t[n]:t[n]}return e},t.renderTime=function(t){var e=t.model.get("timeSpent");if(e.hours>0||e.minutes>0){t.ui.time.hasClass(t.domAttributes.HIDDEN_UTIL_CLASS)&&t.ui.time.removeClass(t.domAttributes.HIDDEN_UTIL_CLASS);var o=Tyto.Utils.getRenderFriendlyTime(e);t.ui.hours.text(o.hours+"h"),t.ui.minutes.text(o.minutes+"m")}else t.ui.time.hasClass(t.domAttributes.HIDDEN_UTIL_CLASS)||t.ui.time.addClass(t.domAttributes.HIDDEN_UTIL_CLASS)}};o["default"]=i},{}],8:[function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(o,"__esModule",{value:!0});var n=t("./column"),s=i(n),l=Backbone.Marionette.CompositeView.extend({tagName:"div",className:function(){return this.domAttributes.VIEW_CLASS},template:function(t){return Tyto.TemplateStore.board(t)},templateHelpers:function(){return{boards:Tyto.Boards}},childView:s["default"],childViewContainer:function(){return this.domAttributes.CHILD_VIEW_CONTAINER_CLASS},childViewOptions:function(t){var e=this,o=Tyto.ActiveTasks.where({columnId:t.id});return{collection:new Tyto.Models.TaskCollection(o),board:e.model}},ui:{addEntity:".tyto-board__add-entity",primaryActions:".tyto-board__actions",boardMenu:".tyto-board__menu",boardSelect:".tyto-board__selector__menu",addColumn:".tyto-board__add-column",addTask:".tyto-board__super-add",deleteBoard:".tyto-board__delete-board",wipeBoard:".tyto-board__wipe-board",emailBoard:".tyto-board__email-board",emailer:".tyto-board__emailer",boardName:".tyto-board__title",columnContainer:".tyto-board__columns",bloomer:".tyto-board__bloomer"},collectionEvents:{destroy:"handleColumnRemoval"},domAttributes:{VIEW_CLASS:"tyto-board",CHILD_VIEW_CONTAINER_CLASS:".tyto-board__columns",COLUMN_CLASS:".tyto-column",COLUMN_ATTR:"data-col-id",COLUMN_MOVER_CLASS:".tyto-column__mover",COLUMN_PLACEHOLDER_CLASS:"tyto-column__placeholder",FAB_MENU_VISIBLE_CLASS:"is-showing-options",ADDING_COLUMN_CLASS:"is--adding-column"},getMDLMap:function(){var t=this;return[{el:t.ui.boardMenu[0],component:"MaterialMenu"},{el:t.ui.boardSelect[0],component:"MaterialMenu"}]},handleColumnRemoval:function(){var t=this,e=t.$el.find(t.domAttributes.COLUMN_CLASS);Tyto.Utils.reorder(t,e,t.domAttributes.COLUMN_ATTR)},events:{"click @ui.addEntity":"showPrimaryActions","click @ui.addColumn":"addNewColumn","click @ui.addTask":"addNewTask","click @ui.deleteBoard":"deleteBoard","click @ui.wipeBoard":"wipeBoard","click @ui.emailBoard":"emailBoard","blur @ui.boardName":"saveBoardName"},showPrimaryActions:function(t){var e=this,o=e.ui.primaryActions[0],i=(e.ui.addEntity[0],e.domAttributes.FAB_MENU_VISIBLE_CLASS),n=function s(e){t.timeStamp!==e.timeStamp&&(o.classList.remove(i),o.IS_SHOWING_MENU=!1,document.removeEventListener("click",s))};o.IS_SHOWING_MENU||(o.IS_SHOWING_MENU=!0,o.classList.add(i),document.addEventListener("click",n))},onBeforeRender:function(){this.collection.models=this.collection.sortBy("ordinal")},onShow:function(){var t=this;Tyto.Utils.upgradeMDL(t.getMDLMap())},onRender:function(){this.bindColumns()},bindColumns:function(){var t=this,e=t.domAttributes;t.ui.columnContainer.sortable({connectWith:e.COLUMN_CLASS,handle:e.COLUMN_MOVER_CLASS,placeholder:e.COLUMN_PLACEHOLDER_CLASS,axis:"x",containment:t.$childViewContainer,stop:function(o,i){var n=Array.prototype.slice.call(t.$el.find(e.COLUMN_CLASS));Tyto.Utils.reorder(t,n,e.COLUMN_ATTR)}})},addNewColumn:function(){var t=this,e=t.model;t.$el.addClass(t.domAttributes.ADDING_COLUMN_CLASS);var o=t.collection;o.add(Tyto.Columns.create({boardId:e.id,ordinal:o.length+1}))},saveBoardName:function(){this.model.save({title:this.ui.boardName.text().trim()})},addNewTask:function(){var t=this,e=t.model,o=_.uniqueId(),i="#board/"+e.id+"/task/"+o+"?isFresh=true";Tyto.Utils.bloom(t.ui.addTask[0],Tyto.DEFAULT_TASK_COLOR,i)},deleteBoard:function(){var t=this;(0===t.collection.length||confirm(Tyto.CONFIRM_MESSAGE))&&(t.wipeBoard(),t.model.destroy(),t.destroy(),Tyto.navigate("/",{trigger:!0}))},wipeBoard:function(t){var e=this,o=function(){e.children.forEach(function(t){for(;0!==t.collection.length;)t.collection.first().destroy();t.model.destroy()})};t?confirm("[tyto] are you sure you wish to wipe the board?")&&o():o()},emailBoard:function(){var t=this,e=Tyto.Utils.getEmailContent(t.model);this.ui.emailer.attr("href",e),this.ui.emailer[0].click()}});o["default"]=l},{"./column":9}],9:[function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(o,"__esModule",{value:!0});var n=t("./task"),s=i(n),l=Backbone.Marionette.CompositeView.extend({tagName:"div",className:function(){return this.domAttributes.VIEW_CLASS},attributes:function(){var t={};return t[this.domAttributes.VIEW_ATTR]=this.model.get("id"),t},template:function(t){return Tyto.TemplateStore.column(t)},childView:s["default"],childViewContainer:function(){return this.domAttributes.CHILD_VIEW_CONTAINER_CLASS},events:{"click @ui.deleteColumn":"deleteColumn","click @ui.addTask":"addTask","blur @ui.columnTitle":"updateTitle"},ui:{deleteColumn:".tyto-column__delete-column",addTask:".tyto-column__add-task",columnTitle:".tyto-column__title",taskContainer:".tyto-column__tasks",columnMenu:".tyto-column__menu"},collectionEvents:{destroy:"handleTaskRemoval"},domAttributes:{VIEW_CLASS:"tyto-column",VIEW_ATTR:"data-col-id",PARENT_CONTAINER_CLASS:".tyto-board__columns",CHILD_VIEW_CONTAINER_CLASS:".tyto-column__tasks",BOARD_CLASS:".tyto-board",COLUMN_ADD_CLASS:"is--adding-column",TASK_ADD_CLASS:"is--adding-task",TASK_ATTR:"data-task-id",TASK_CLASS:".tyto-task",TASK_MOVER_CLASS:".tyto-task__mover",TASK_PLACEHOLDER_CLASS:"tyto-task__placeholder"},getMDLMap:function(){var t=this;return[{el:t.ui.columnMenu[0],component:"MaterialMenu"}]},handleTaskRemoval:function(t){var e=this,o=e.domAttributes,i=Array.prototype.slice.call(e.$el.find(o.TASK_CLASS));Tyto.Utils.reorder(e,i,o.TASK_ATTR)},initialize:function(){var t=this,e=t.domAttributes;t.$el.on(Tyto.ANIMATION_EVENT,function(){t.$el.parents(e.BOARD_CLASS).removeClass(e.COLUMN_ADD_CLASS);
})},onBeforeRender:function(){this.collection.models=this.collection.sortBy("ordinal")},bindTasks:function(){var t=this,e=t.domAttributes;t.ui.taskContainer.sortable({connectWith:e.CHILD_VIEW_CONTAINER_CLASS,handle:e.TASK_MOVER_CLASS,placeholder:e.TASK_PLACEHOLDER_CLASS,containment:t.domAttributes.PARENT_CONTAINER_CLASS,stop:function(o,i){var n=void 0,s=void 0,l=t.collection.get(i.item.attr(e.TASK_ATTR)),a=t,r=$(i.item).parents("["+e.VIEW_ATTR+"]").attr(e.VIEW_ATTR);r!==l.get("columnId")&&(s=Tyto.Columns.get(r),a=Tyto.BoardView.children.findByModel(s),n=a.$el.find(e.TASK_CLASS),l.save({columnId:r}),t.collection.remove(l),a.collection.add(l),Tyto.Utils.reorder(a,n,e.TASK_ATTR),a.render(),a.upgradeComponents()),n=t.$el.find(e.TASK_CLASS),Tyto.Utils.reorder(t,n,e.TASK_ATTR),t.render(),t.upgradeComponents()}})},onShow:function(){var t=this,e=t.domAttributes,o=$(e.PARENT_CONTAINER_CLASS)[0],i=t.$el.parents(e.BOARD_CLASS);o.scrollWidth>window.outerWidth&&i.hasClass(e.COLUMN_ADD_CLASS)&&(o.scrollLeft=o.scrollWidth),t.upgradeComponents()},onRender:function(){this.bindTasks()},upgradeComponents:function(){var t=this;Tyto.Utils.upgradeMDL(t.getMDLMap())},updateTitle:function(){this.model.save({title:this.ui.columnTitle.text()})},addTask:function(){var t=this,e=t.domAttributes;this.collection.add(Tyto.Tasks.create({columnId:t.model.id,boardId:t.options.board.id,ordinal:t.collection.length+1})),t.$el.addClass(e.TASK_ADD_CLASS)},deleteColumn:function(){if(0===this.collection.length||confirm(Tyto.CONFIRM_MESSAGE)){for(;0!==this.collection.length;)this.collection.first().destroy();this.model.destroy()}}});o["default"]=l},{"./task":15}],10:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({template:function(t){return Tyto.TemplateStore.cookieBanner(t)},ui:{closeBtn:".tyto-cookies__accept"},events:{"click @ui.closeBtn":"closeBanner"},closeBanner:function(){window.localStorage.setItem("tyto",!0),Tyto.RootView.removeRegion("Cookie"),this.destroy()}});o["default"]=i},{}],11:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({template:function(t){return Tyto.TemplateStore.edit(t)},className:function(){return this.domAttributes.VIEW_CLASS},templateHelpers:function(){var t=this;return{selectedColumn:_.findWhere(t.options.columns,{id:t.model.get("columnId")}),board:this.options.board,columns:_.sortBy(this.options.columns,"attributes.title"),isNew:this.options.isNew,colors:Tyto.TASK_COLORS}},domAttributes:{VIEW_CLASS:"tyto-edit",BLOOM_SHOW_CLASS:"is--showing-bloom",EDIT_SHOW_CLASS:"is--showing-edit-view",MODEL_PROP_ATTR:"data-model-prop",HIDDEN_UTIL_CLASS:"is--hidden"},props:{DEFAULT_COLOR_VALUE:"default"},ui:{save:".tyto-edit__save",color:".tyto-edit__color-select__menu-option",taskDescription:".tyto-edit__task-description",editDescription:".tyto-edit__edit-description",suggestions:".tyto-task__suggestions",taskTitle:".tyto-edit__task-title",column:".tyto-edit__column-select__menu-option",colorMenu:".tyto-edit__color-select__menu",columnMenu:".tyto-edit__column-select__menu",columnLabel:".tyto-edit__task-column",track:".tyto-edit__track",time:".tyto-edit__task-time",hours:".tyto-edit__task-time__hours",minutes:".tyto-edit__task-time__minutes"},events:{"click @ui.save":"saveTask","click @ui.color":"changeColor","click @ui.column":"changeColumn","click @ui.track":"trackTime","click @ui.taskDescription":"showEditMode","blur @ui.editDescription":"updateTask","blur @ui.taskTitle":"updateTask","keydown @ui.taskTitle":"updateTask","keypress @ui.editDescription":"handleKeyInteraction","keydown @ui.editDescription":"handleKeyInteraction","keyup @ui.editDescription":"handleKeyInteraction","click @ui.suggestions":"selectSuggestion"},initialize:function(){var t=this;Tyto.Suggestions.bootstrapView(t),Tyto.RootView.el.classList.add("bg--"+t.model.get("color")),Tyto.RootView.el.classList.remove(t.domAttributes.BLOOM_SHOW_CLASS)},getMDLMap:function(){var t=this;return[{el:t.ui.columnMenu[0],component:"MaterialMenu"},{el:t.ui.colorMenu[0],component:"MaterialMenu"}]},handleKeyInteraction:function(t){27===t.which&&this.updateTask(t),this.filterItems(t)},updateTask:function(t){var e=this,o=e.domAttributes,i=t.target,n="TEXTAREA"===i.nodeName?i.value:i.innerHTML;if(e.model.set(i.getAttribute(o.MODEL_PROP_ATTR),n),"TEXTAREA"===i.nodeName){var s=e.ui.taskDescription,l=e.ui.editDescription;s.html(marked(l.val())),l.addClass(o.HIDDEN_UTIL_CLASS),s.removeClass(o.HIDDEN_UTIL_CLASS)}"keydown"===t.type&&27===t.which&&this.ui.taskTitle.blur()},onShow:function(){Tyto.Utils.upgradeMDL(this.getMDLMap())},onRender:function(){var t=this;t.ui.taskDescription.html(marked(t.model.get("description"))),Tyto.Utils.autoSize(t.ui.editDescription[0]),Tyto.Utils.renderTime(t)},trackTime:function(){Tyto.Utils.showTimeModal(this.model,this)},showEditMode:function(){var t=this.domAttributes,e=this.model,o=this.ui.taskDescription,i=this.ui.editDescription;o.addClass(t.HIDDEN_UTIL_CLASS),i.removeClass(t.HIDDEN_UTIL_CLASS).val(e.get("description")).focus()},saveTask:function(){var t=this,e=function(){delete t.model.attributes.id,Tyto.Tasks.create(t.model.attributes),Tyto.navigate("/board/"+t.options.board.id,!0)};if(0===t.options.columns.length||t.selectedColumnId){if(0!==t.options.columns.length&&t.selectedColumnId)e();else if(0===t.options.columns.length){var o=Tyto.Columns.create({boardId:t.options.board.id,ordinal:1});t.model.set("columnId",o.id),t.model.set("ordinal",1),e()}}else alert("whoah, you need to select a column for that new task")},changeColumn:function(t){var e=this,o=t.target.getAttribute("data-column-id");if(o!==e.model.get("columnId")){e.ui.column.removeClass(Tyto.SELECTED_CLASS),t.target.classList.add(Tyto.SELECTED_CLASS);var i=Tyto.Tasks.where({columnId:o}).length+1;e.ui.columnLabel.text(t.target.textContent),e.selectedColumnId=o,e.model.set("columnId",o),e.model.set("ordinal",i)}},changeColor:function(t){var e=this,o=t.target.getAttribute("data-color");Tyto.RootView.el.classList.add(e.domAttributes.EDIT_SHOW_CLASS),o!==e.props.DEFAULT_COLOR_VALUE&&(e.ui.color.removeClass(Tyto.SELECTED_CLASS),t.target.classList.add(Tyto.SELECTED_CLASS),Tyto.RootView.el.classList.remove("bg--"+e.model.get("color")),Tyto.RootView.el.classList.add("bg--"+o),e.model.set("color",o))},onBeforeDestroy:function(){var t=this;Tyto.RootView.$el.removeClass("bg--"+t.model.get("color")),Tyto.RootView.$el.removeClass(t.domAttributes.EDIT_SHOW_CLASS),t.options.isNew||t.model.save()}});o["default"]=i},{}],12:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({template:function(t){return Tyto.TemplateStore.menu(t)},tagName:"div",className:function(){return this.domAttributes.VIEW_CLASS},ui:{addBoardBtn:".tyto-menu__add-board",exportBtn:".tyto-menu__export",loadBtn:".tyto-menu__load",importBtn:".tyto-menu__import",deleteBtn:".tyto-menu__delete-save",exporter:".tyto-menu__exporter",importer:".tyto-menu__importer",action:"button"},events:{"click  @ui.addBoardBtn":"addBoard","click  @ui.exportBtn":"exportData","click  @ui.deleteBtn":"deleteAppData","click  @ui.loadBtn":"initLoad","click  @ui.importBtn":"initLoad","click  @ui.action":"restoreContent","change @ui.importer":"handleFile"},props:{DOWNLOAD_FILE_NAME:"barn.json"},domAttributes:{VIEW_CLASS:"tyto-menu",MENU_VISIBLE_CLASS:"is-visible"},onShow:function(){var t=this;t.reader=new FileReader,t.reader.onloadend=function(e){var o=JSON.parse(e.target.result);t.activeImporter.id===t.ui.loadBtn.attr("id")?Tyto.Utils.load(o,!1,!0):Tyto.Utils.load(o,!0,!1),Tyto.navigate("/",!0)}},restoreContent:function(){var t=this.domAttributes,e=Tyto.RootView.getRegion("Menu").$el.parent().find("."+t.MENU_VISIBLE_CLASS);e.removeClass(t.MENU_VISIBLE_CLASS)},handleFile:function(t){var e=this,o=t.target.files[0];o.type.match("application/json")||o.name.indexOf(!0)?(e.reader.readAsText(o),this.ui.importer[0].value=null):alert("[tyto] only valid json files allowed")},initLoad:function(t){this.activeImporter=t.currentTarget;var e=this.ui.importer[0];window.File&&window.FileReader&&window.FileList&&window.Blob?e.click():alert("[tyto] Unfortunately the file APIs are not fully supported in your browser")},exportData:function(){var t=this,e=t.ui.exporter[0],o={};_.forOwn(window.localStorage,function(t,e){if(e.indexOf("tyto")!==-1)return o[e]=t});var i=t.props.DOWNLOAD_FILE_NAME,n="data:text/plain,"+JSON.stringify(o);e.setAttribute("download",i),e.setAttribute("href",n),e.click()},deleteAppData:function(){_.forOwn(window.localStorage,function(t,e){if(e.indexOf("tyto")!==-1&&"tyto"!==e)return window.localStorage.removeItem(e)}),Tyto.Boards.reset(),Tyto.Columns.reset(),Tyto.Tasks.reset(),Tyto.navigate("/",!0)},addBoard:function(){Tyto.navigate("board/"+Tyto.Boards.create().id,!0)}});o["default"]=i},{}],13:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.LayoutView.extend({el:"#tyto-app",regions:{Menu:"#tyto-menu",Content:"#tyto-content"}});o["default"]=i},{}],14:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({template:function(t){return Tyto.TemplateStore.select(t)},tagName:"div",className:function(){return this.domAttributes.VIEW_CLASS},ui:{add:".tyto-select__add-board",load:".tyto-select__load-intro-board",boardSelector:".tyto-select__board-selector"},events:{"click @ui.add":"addBoard","change @ui.boardSelector":"showBoard","click @ui.load":"loadIntro"},domAttributes:{VIEW_CLASS:"tyto-select"},collectionEvents:{all:"render"},addBoard:function(){this.showBoard(Tyto.Boards.create().id)},loadIntro:function(){var t=this,e=void 0;Tyto.RootView.$el.addClass(Tyto.LOADING_CLASS),$.getJSON(Tyto.INTRO_JSON_SRC,function(o){Tyto.RootView.$el.removeClass(Tyto.LOADING_CLASS),Tyto.Utils.load(o,!0,!1),_.forOwn(o,function(t,o){o.indexOf("tyto--board-")!==-1&&(e=JSON.parse(t).id)}),t.showBoard(e)})},showBoard:function(t){"string"!=typeof t&&(t=this.ui.boardSelector.val()),Tyto.navigate("board/"+t,{trigger:!0})}});o["default"]=i},{}],15:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({tagName:"div",className:function(){return this.domAttributes.VIEW_CLASS+this.model.attributes.color},attributes:function(){var t={};return t[this.domAttributes.VIEW_ATTR]=this.model.get("id"),t},template:function(t){return Tyto.TemplateStore.task(t)},ui:{deleteTask:".tyto-task__delete-task",editTask:".tyto-task__edit-task",trackTask:".tyto-task__track-task",description:".tyto-task__description",title:".tyto-task__title",menu:".tyto-task__menu",hours:".tyto-task__time__hours",minutes:".tyto-task__time__minutes",time:".tyto-task__time",editDescription:".tyto-task__description-edit",suggestions:".tyto-task__suggestions"},events:{"click @ui.deleteTask":"deleteTask","click @ui.editTask":"editTask","click @ui.trackTask":"trackTask","blur  @ui.title":"saveTaskTitle","keydown @ui.title":"saveTaskTitle","blur  @ui.editDescription":"saveTaskDescription","click @ui.description":"showEditMode","keypress @ui.editDescription":"handleKeyInteraction","keydown @ui.editDescription":"handleKeyInteraction","keyup @ui.editDescription":"handleKeyInteraction","click @ui.suggestions":"selectSuggestion"},domAttributes:{VIEW_CLASS:"tyto-task mdl-card mdl-shadow--2dp bg--",VIEW_ATTR:"data-task-id",IS_BEING_ADDED_CLASS:"is--adding-task",COLUMN_CLASS:".tyto-column",TASK_CONTAINER_CLASS:".tyto-column__tasks",HIDDEN_UTIL_CLASS:"is--hidden",INDICATOR:".indicator"},getMDLMap:function(){var t=this;return[{el:t.ui.menu[0],component:"MaterialMenu"}]},handleKeyInteraction:function(t){27===t.which&&this.saveTaskDescription(),this.filterItems(t)},initialize:function(){var t=this,e=t.domAttributes;Tyto.Suggestions.bootstrapView(t),t.$el.on(Tyto.ANIMATION_EVENT,function(){$(this).parents(e.COLUMN_CLASS).removeClass(e.IS_BEING_ADDED_CLASS)})},deleteTask:function(){confirm(Tyto.CONFIRM_MESSAGE)&&this.model.destroy()},onShow:function(){var t=this,e=t.domAttributes,o=t.$el.parents(e.TASK_CONTAINER_CLASS)[0];t.$el.parents(e.COLUMN_CLASS);o.scrollHeight>o.offsetHeight&&(o.scrollTop=o.scrollHeight),Tyto.Utils.upgradeMDL(t.getMDLMap())},onRender:function(){var t=this;t.ui.description.html(marked(t.model.get("description"))),Tyto.Utils.autoSize(t.ui.editDescription[0]),Tyto.Utils.renderTime(t)},trackTask:function(t){Tyto.Utils.showTimeModal(this.model,this)},editTask:function(t){var e=this,o=e.model.get("boardId"),i=e.model.id,n="#board/"+o+"/task/"+i;Tyto.Utils.bloom(e.ui.editTask[0],e.model.get("color"),n)},showEditMode:function(){var t=this.domAttributes,e=this.model,o=this.ui.description,i=this.ui.editDescription;o.addClass(t.HIDDEN_UTIL_CLASS),i.removeClass(t.HIDDEN_UTIL_CLASS).val(e.get("description")).focus()},saveTaskDescription:function(t){var e=this.domAttributes,o=this.ui.editDescription,i=this.ui.description;o.addClass(e.HIDDEN_UTIL_CLASS),i.removeClass(e.HIDDEN_UTIL_CLASS);var n=o.val();this.model.save({description:n}),i.html(marked(n)),this.hideSuggestions()},saveTaskTitle:function(t){this.model.save({title:this.ui.title.text().trim()}),"keydown"===t.type&&27===t.which&&this.ui.title.blur()}});o["default"]=i},{}],16:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=Backbone.Marionette.ItemView.extend({template:function(t){return Tyto.TemplateStore.timeModal(t)},className:function(){return this.domAttributes.VIEW_CLASS},domAttributes:{VIEW_CLASS:"tyto-time-modal",PLAY_ICON:"play_arrow",PAUSE_ICON:"pause"},ui:{timerBtn:".tyto-time-modal__timer",taskDescription:".tyto-time-modal__content-description",timerIcon:".tyto-time-modal__timer-icon",resetBtn:".tyto-time-modal__timer-reset",closeBtn:".tyto-time-modal__close",timeLbl:".tyto-time-modal__timer-lbl",hours:".tyto-time-modal__timer-lbl-hours",minutes:".tyto-time-modal__timer-lbl-minutes",seconds:".tyto-time-modal__timer-lbl-seconds"},events:{"click @ui.closeBtn":"closeModal","click @ui.timerBtn":"toggleTimer","click @ui.resetBtn":"resetTimer"},startTimer:function(){var t=this;t.isTiming=!0,t.ui.timerIcon.text(t.domAttributes.PAUSE_ICON),t.ui.resetBtn.attr("disabled",!0),t.ui.resetBtn.removeClass("mdl-button--accent"),t.ui.closeBtn.attr("disabled",!0),t.ui.closeBtn.removeClass("mdl-button--accent"),t.timingInterval=setInterval(function(){t.incrementTime(),t.renderTime()},1e3)},incrementTime:function(){var t=this,e=t.model.get("timeSpent");if(e.seconds++,e.seconds>=60&&(e.seconds=0,e.minutes++,e.minutes>=60))return e.minutes=0,e.hours++},renderTime:function(){for(var t=this,e=Tyto.Utils.getRenderFriendlyTime(t.model.get("timeSpent")),o=["hours","minutes","seconds"],i=0;i<o.length;i++){var n=o[i];t.ui[n].text()!==e[n]&&t.ui[n].text(e[n])}},onRender:function(){var t=this;t.ui.taskDescription.html(marked(t.model.get("description"))),t.renderTime()},stopTimer:function(){var t=this;t.isTiming=!1,t.ui.timerIcon.text(t.domAttributes.PLAY_ICON),t.ui.resetBtn.removeAttr("disabled"),t.ui.resetBtn.addClass("mdl-button--accent"),t.ui.closeBtn.removeAttr("disabled"),t.ui.closeBtn.addClass("mdl-button--accent"),clearInterval(t.timingInterval)},resetTimer:function(){var t=this;t.model.set("timeSpent",{hours:0,minutes:0,seconds:0}),t.renderTime()},toggleTimer:function(){var t=this;t.isTiming?t.stopTimer():t.startTimer()},closeModal:function(){var t=this;t.model.save({timeSpent:t.model.get("timeSpent")}),Tyto.RootView.getRegion("TimeModal").$el.remove(),Tyto.RootView.removeRegion("TimeModal"),Tyto.Utils.renderTime(t.options.modelView),t.destroy()}});o["default"]=i},{}],17:[function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(o,"__esModule",{value:!0});var n=t("./task"),s=i(n),l=t("./board"),a=i(l),r=t("./column"),d=i(r),u=t("./edit"),c=i(u),m=t("./root"),_=i(m),p=t("./menu"),y=i(p),b=t("./select"),f=i(b),T=t("./cookie"),h=i(T),S=t("./time"),v=i(S),g=function(t,e,o){t.Root=_["default"],t.Task=s["default"],t.Column=d["default"],t.Board=a["default"],t.Edit=c["default"],t.Menu=y["default"],t.Select=f["default"],t.CookieBanner=h["default"],t.TimeModal=v["default"]};o["default"]=g},{"./board":8,"./column":9,"./cookie":10,"./edit":11,"./menu":12,"./root":13,"./select":14,"./task":15,"./time":16}]},{},[1])}();